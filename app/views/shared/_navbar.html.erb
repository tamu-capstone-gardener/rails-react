<nav data-controller="navbar" data-navbar-state-value="false" class="fixed top-0 w-full theme-bg-alt border-gray-200 z-50">
  <div class="max-w-screen-xl flex items-center justify-between lg:justify-evenly mx-auto p-4">
    <div class="flex w-full justify-start items-center text-2xl font-bold"
      <h2 class="theme-text-primary w-full">Plant<span class="p-1 theme-text-primary">Hub</span></h2>
    </div>
    <!-- Toggle button visible on mobile only -->
    <div class="flex w-full justify-center items-center">
      <button type="button"
              class="theme-text-primary !focus:text-green-300 focus:outline-none !hover:text-green-300 block lg:hidden hover:cursor-pointer w-full"
              data-action="click->navbar#toggle">
        <span class="sr-only">Open main menu</span>
        <svg class="h-8 w-8 fill-current" xmlns="http://www.w3.org/2000/svg"
            fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <!-- X icon for closing (hidden by default) -->
          <path data-navbar-target="x" stroke-linecap="round" stroke-linejoin="round"
                d="M6 18L18 6M6 6l12 12" class="hidden" />
          <!-- Bars icon for opening -->
          <path data-navbar-target="bars" stroke-linecap="round" stroke-linejoin="round"
                d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
      </button>
      
      <!-- Desktop inline menu -->
      <div class="hidden lg:flex items-center justify-center space-x-2 w-full">
        <% @page_links.each do |link| %>
          <%= link_to link[:name], link[:path], class: "font-semibold btn-primary rounded px-2 py-1" %>
        <% end %>
      </div>
    </div>
    <div class="flex w-full items-center justify-end">
      <button 
        type="button" 
        data-action="dark-mode#toggle"
        class="px-4 py-2 btn-secondary rounded-lg text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"
      >
        Toggle Dark Mode
      </button>
    </div>
  </div>
  <!-- Mobile dropdown menu (initially hidden) positioned below the navbar -->
  <div data-navbar-target="menu" class="hidden absolute left-0 right-0 top-full bg-white border-t theme-bg-alt">
    <% @page_links.each do |link| %>
      <%= link_to link[:name], link[:path], class: "block btn-primary font-semibold px-4 py-2" %>
    <% end %>
  </div>
</nav>
<script>
    document.addEventListener("DOMContentLoaded", function() {
    // On page load, set the global variable based on the current mode
    window.isDarkMode = document.documentElement.classList.contains("dark");

    const toggleBtn = document.getElementById("dark-mode-toggle");
    if (toggleBtn) {
        toggleBtn.addEventListener("click", function() {
        // Toggle dark mode class on <html>
        const htmlEl = document.documentElement;
        const darkMode = htmlEl.classList.toggle("dark");
        // Update the global variable
        window.isDarkMode = darkMode;
        });
    }
    });
</script>